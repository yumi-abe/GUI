# 日興証券のクロス取引（信用取引）手数料計算ツール

## 概要
このツールは、日興証券を利用したクロス取引（信用取引）の手数料を計算するためのツールです。  
distディレクトリをダウンロードしmain.exeを実行するとローカル環境でも実行可能です。
下記設計資料の手数料計算パートのみを試しに作成
https://docs.google.com/spreadsheets/d/1MDWPg_FjTnBP4PZJ_VAoLTPq4PB3Qd5ZmHL2VHUcgL8/edit?gid=134707271#gid=134707271

1. **株価情報の取得**  
   Yahoo Finance APIを使用して、指定された銘柄の最新株価を取得

2. **日本取引所（JPX）データの利用**  
   株式上場データや市場休日データを取得して、計算に反映

3. **保有日数の計算**  
   株式市場の休日を考慮して、実際の保有日数を自動計算

4. **手数料の算出**  
   日興証券の手数料体系に基づき、取引金額や保有日数をもとに手数料を算出

## 使用ファイル
**main.py**  
   Tkinterで見た目部分を表示、modulesの関数を呼び出して処理を実行

**modules/BusinessDayCaluculator.py**  
   土日祝・休業日を除いた営業日数を計算する

**modules/DataFetcher.py**  
   市場休日、株式上場一覧をスクレイピングで取得しデータベースへ保存

**modules/functions.py**  
   string-date型変換、日数差計算

**modules/Get_DBdata.py**  
   データベースから休日一覧、株式上場一覧データ取得

**modules/stock_search.py**  
   yfinanceAPIで入力した銘柄コードに該当する株式情報を取得

## 使用方法
**「銘柄コード」を入力（必須ではない）**  
証券コード（英数字4桁）入力して検索ボタンを押すと株価を検索できます。
検索して該当の銘柄があった場合は「株価」に自動で反映されます。
株価を手動で入力する場合は飛ばしてください。

**「株価」を入力**  
株価を直接入力したい場合は1株あたりの株価を入力します。

**「株数」を選択**  
取得予定の株数を選択します。

**「取得日」を選択**  
約定日を選択します。

**「優待月」を選択**  
優待を取得できる月を選択します。  

**「手数料計算」を押す**  
選択した内容に応じた手数料が計算されます。  

例）銘柄名：イオン株式会社（コード：8267） 優待月2月、8月 の場合  
取得日：2/3　優待月：2月  で計算すると、手数料を表示します。

